<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
	jQuery(document).ready(function(){
		
		function getWeekNumber(d) {
			// Copy date so don't modify original
			d = new Date(d);
			d.setHours(0,0,0);
			// Set to nearest Thursday: current date + 4 - current day number
			// Make Sunday's day number 7
			d.setDate(d.getDate() + 4 - (d.getDay()||7));
			// Get first day of year
			var yearStart = new Date(d.getFullYear(),0,1);
			// Calculate full weeks to nearest Thursday
			var weekNo = Math.ceil(( ( (d - yearStart) / 86400000) + 1)/7)
			// Return array of year and week number
			return weekNo;
	    }
	
	    var mydate = new Date();
	    var weeknumber = getWeekNumber(mydate);
		
    	jQuery.ajax({
			url: 'http://www.knkv.nl/kcp/ef0baad8aa6d23b60/',
			type: 'POST',
			dataType: "jsonp",
			jsonp: 'callback',
			jsonpCallback : 'jsonp_return',
			data: {
				f: 	'get_program',
				full:'1'
			},
			success: function(results){
				
				jQuery.each(results, function(current_date, matches) {
					
					//console.log(matches);

					var week_start 	= matches.week_start;
					var week_end	= matches.week_end;
					var week_number = matches.week_number;

					jQuery.each(matches.items, function(count, match) {

						jQuery.ajax({

							url:  'cron_program.php',
							type: 'POST',
							data: {
								week:			week_number,
								week_start:		week_start,
								week_end:		week_end,
								match:			match
							}

						});
						
					});
					
				});
				
				getResults();
				
			}

		});
		
		function getResults() {

			jQuery.ajax({
				url: 'http://www.knkv.nl/kcp/ef0baad8aa6d23b60/',
				type: 'POST',
				dataType: "jsonp",
				jsonp: 'callback',
				jsonpCallback : 'jsonp_return',
				data: {
					f:'get_results',
					p: -1,
					full:'1'
				},
				success: function(results){
					jQuery.each(results, function(current_date, matches) {

						//console.log(matches);							

						var week_start 	= matches.week_start;
						var week_end	= matches.week_end;
						var week_number = matches.week_number;

						jQuery.each(matches.items, function(count, match) {

							jQuery.ajax({

								url: 'cron_program.php',
								type: 'POST',
								data: {
									week:			week_number,
									week_start:		week_start,
									week_end:		week_end,
									match:			match
								}

							});
							
						});
						
					});

				}
			});
		}
	    
	});
</script>